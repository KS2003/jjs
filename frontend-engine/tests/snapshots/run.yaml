description: |
  tests operations with run
  Since it is not end-to-end test, it doesn't check judging
env:
  toolchains:
    cpp: |
      title = "C++"
      filename = "source.cpp"

      [[build]]
      argv = ["not", "matters"]

      [run]
      argv = ["not", "matters"]

steps:
  - query: |
      query GetNonExistingRun {
          runs(id: 0) {
              toolchain {
                  name
              }
          }
      }
    res:
      runs: []
  - eval:
      - var: runCode
        fn: base64::encode
        data: |
          #include <cstdio>

          int main() {
              int a, b;
              scanf("%d %d", &a, &b);
              printf("%d", a + b);
          }
    query: |
      mutation CreateRun($runCode: String!) {
          submitSimple(toolchain: "cpp", runCode: $runCode, problem: "A", contest: "TODO") {
              id
          }
      }
    res:
      submitSimple:
        id: 0
  - query: |
      query GetRun {
          runs(id: 0) {
              source
          }
      }
    res:
      runs:
        - source: I2luY2x1ZGUgPGNzdGRpbz4KCmludCBtYWluKCkgewogICAgaW50IGEsIGI7CiAgICBzY2FuZigiJWQgJWQiLCAmYSwgJmIpOwogICAgcHJpbnRmKCIlZCIsIGEgKyBiKTsKfQo=